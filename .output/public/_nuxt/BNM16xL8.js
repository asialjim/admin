import{E as C,a as k,b as I}from"./BAw1MrN-.js";import{E as T}from"./BmJm0hZK.js";import{d as P,r as i,o as U,L as f,M as _,J as B,K as w,x as g,z as u,B as o,C as a,y as v,R as F,D as y,a0 as R,T as A,a1 as M}from"./yHbOXYhg.js";import{_ as N}from"./DlAUqK2U.js";const q={class:"create-admin-container"},D={class:"create-admin-form-wrapper"},z={key:0,class:"success-message"},J=P({__name:"create-admin",setup(K){const m=B(),p=i(),l=i(!1),c=i(!1);U(async()=>{try{const s=await f.get("/api/open/admin/user/user/registrar/root");s&&s.status===200&&(_.info("超级管理员已存在，正在跳转到门户页面..."),setTimeout(()=>{m.push("/dashboard")},1e3))}catch{}});const r=w({password:"",confirmPassword:""}),b=w({password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:32,message:"密码长度在 6 到 32 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(s,e,t)=>{e!==r.password?t(new Error("两次输入的密码不一致")):t()},trigger:"blur"}]}),h=async()=>{var s;try{await((s=p.value)==null?void 0:s.validate()),l.value=!0;const e={userid:"root",appid:"root",chlType:"PC",chlAppId:"root",chlAppType:"CMS",chlUserId:"root",chlUnionId:"",chlUserCode:r.password,chlUserToken:""};await f.register("/api/open/admin/user/user/registrar/register",e),_.success("超级管理员账户创建成功！"),c.value=!0,setTimeout(()=>{m.push("/login")},2e3)}catch{}finally{l.value=!1}};return(s,e)=>{const t=I,n=k,E=T,V=R,x=C;return v(),g("div",q,[u("div",D,[e[5]||(e[5]=u("h2",null,"创建超级管理员账户",-1)),o(x,{ref_key:"adminFormRef",ref:p,model:r,rules:b,class:"create-admin-form","label-position":"top"},{default:a(()=>[o(n,{label:"密码",prop:"password"},{default:a(()=>[o(t,{modelValue:r.password,"onUpdate:modelValue":e[0]||(e[0]=d=>r.password=d),type:"password",placeholder:"请输入密码","prefix-icon":"el-icon-lock","show-password":""},null,8,["modelValue"]),e[2]||(e[2]=u("div",{class:"form-tip"},"密码将用于超级管理员账户认证",-1))]),_:1}),o(n,{label:"确认密码",prop:"confirmPassword"},{default:a(()=>[o(t,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[1]||(e[1]=d=>r.confirmPassword=d),type:"password",placeholder:"请再次输入密码","prefix-icon":"el-icon-lock","show-password":""},null,8,["modelValue"])]),_:1}),o(n,null,{default:a(()=>[o(E,{type:"primary",class:"create-button",loading:l.value,onClick:h},{default:a(()=>[...e[3]||(e[3]=[y(" 创建账户 ",-1)])]),_:1},8,["loading"])]),_:1}),c.value?(v(),g("div",z,[o(V,null,{default:a(()=>[o(A(M))]),_:1}),e[4]||(e[4]=y(" 超级管理员账户创建成功！ ",-1))])):F("",!0)]),_:1},8,["model","rules"])])])}}}),H=N(J,[["__scopeId","data-v-fef4bb9c"]]);export{H as default};
